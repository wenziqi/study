2020.10.28
今天继续优化代码。
1）一些比较大的数组便利，改成for i=1，#tb do end 的方式

2）活动目录下共有100多个活动，玩家登陆时处理非常耗时。huodong.onlogin，优化后一次执行消耗平均10ms，2000个玩家同时登陆消耗要近20s。继续排查发现，大部分活动onlogin接口消耗很低，主要集中在某些活动，明天计划继续针对这些活动优化，估计是因为策划导表数据很大，for循环处理太耗时。

―――――――――――――――――
1.查找下一个任务findnexttask，居然是for循环遍历所有的主线任务！看了导表，主线任务多打1000多个。而且登陆时就会调用这个接口。这么暴力。这个设计本身就有问题。

2.全服广播的逻辑居然是在逻辑服实现，没有另外设计服务器转发处理。太不可思议。

3.整游戏架构居然简单到只有逻辑服和战斗服。实在是不可思议。

4.没设计db服务器。数据库操作居然是同步的。

5.登陆业务逻辑没有拆分处理。